<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Scanner de Reçus</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="scanner-container">
    
    <!-- Image capturée -->
    <div *ngIf="capturedImage" class="captured-image-container">
      <img [src]="capturedImage" alt="Reçu capturé" class="captured-image">
      
      <!-- Indicateur de scan -->
      <div *ngIf="isScanning" class="scanning-overlay">
        <ion-spinner name="crescent"></ion-spinner>
        <p>Analyse en cours...</p>
      </div>
    </div>

    <!-- Interface de scan -->
    <div *ngIf="!capturedImage" class="scan-interface">
      <div class="scan-icon">
        <ion-icon name="camera" size="large"></ion-icon>
      </div>
      
      <h2>Scanner un Reçu</h2>
      <p>Prenez une photo de votre reçu ou sélectionnez une image existante</p>
      
      <div class="scan-buttons">
        <ion-button expand="block" (click)="takePicture()" color="primary">
          <ion-icon name="camera" slot="start"></ion-icon>
          Prendre une Photo
        </ion-button>
        
        <ion-button expand="block" (click)="selectFromGallery()" color="secondary" fill="outline">
          <ion-icon name="images" slot="start"></ion-icon>
          Sélectionner une Image
        </ion-button>
        
        <ion-button expand="block" (click)="openFileInput()" color="medium" fill="outline">
          <ion-icon name="folder" slot="start"></ion-icon>
          Choisir un Fichier
        </ion-button>
      </div>
    </div>

    <!-- Boutons d'action après capture -->
    <div *ngIf="capturedImage && !isScanning" class="action-buttons">
      <ion-button expand="block" (click)="resetScanner()" color="danger" fill="outline">
        <ion-icon name="refresh" slot="start"></ion-icon>
        Recommencer
      </ion-button>
    </div>

    <!-- Input file caché -->
    <input 
      #fileInput
      type="file" 
      accept="image/*" 
      style="display: none;"
      (change)="onFileSelected($event)">
  </div>
</ion-content>
